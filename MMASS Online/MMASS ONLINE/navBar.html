<!--<head>
    <link rel="shortcut icon" href="favicon.svg">
</head>-->
<style>
    /*.nav-item {
        max-width: min-content;
    }*/

    .navbar {
        padding: 0 1rem;
        position: fixed;
        top: 0;
        width: 100%;
    }

    .navbar li {
        text-align: center;
    }

    .shadow {
        box-shadow: 0 .9rem 1rem rgba(0,0,0,.40) !important;
    }

    @media (max-width: 767px) {
        #divVencApi {
            position: fixed;
            width: 100%;
            bottom: 2px;
            text-align: center;
        }
    }

    @media screen {

        #divVencApi {
            position: fixed;
            left: 99%;
            margin-left: -200px;
            width: 200px;
            bottom: 30px;
            text-align: center;
            background: rgb(204, 204, 204); /* Fallback for older browsers without RGBA-support */
            background: rgba(204, 204, 204, 0.2);
            color: #c2c2c2;
            border-color: #c2c2c2;
            border: transparent;
        }
    }

    .btn-danger {
        color: #fff;
        background-color: #52217d;
        border-color: #52217d;
        transition: all 0.2s;
    }

    .btn-danger:hover {
        background-color: #7b00ce;
        border-color: #7b00ce;
    }

    .btn-danger:active {
        background-color: #52217d !important;
        border-color: #52217d !important;
    }

</style>

<!-- Modal Mensajes -->
<div class="modal fade" id="modalInfo" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content shadow p-3 mb-5 bg-white rounded">
            <div class="modal-header d-flex justify-content-center">
                <h5 class="modal-title" id="modalCenterTitle">
                    <span class="fa fa-info-circle" style="color: #52217d;"></span>
                        Información del sistema
                </h5>
            </div>
            <div class="modal-body" id="modalInfoBody">

            </div>
            <div class="modal-footer d-flex justify-content-end" id="modalInfoFooter">

            </div>
        </div>
    </div>
</div>

<!--Notificación vencimiento versión API-->
<div id="divVencApi" style="display:none;cursor:pointer;z-index:10000;" title="Click para cerrar" onclick="cerrarNoti()"></div>

<nav class="navbar navbar-expand-lg navbar-dark sticky-top bg-dark shadow">
    <!--<a class="navbar-brand" href="OrdenList.html">-->
    <a class="navbar-brand" id="navBarLogo" href="">
        <!--<img src="/img/logoMmassOnlineFO.svg" width="120" height="35" class="d-inline-block align-top" alt="">-->
        <img src="/img/logoNavbar2.png" width="120" height="35" class="d-inline-block align-top" alt="">
        <!--MMASS Online-->
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item d-flex align-items-center">
                <a class="nav-link ocultar" href="tarifaslist.html">Tarifas</a>
            </li>
            <li class="nav-item d-flex align-items-center">
                <a class="nav-link ocultar" href="tiposavisoslist.html">Tipos de Aviso</a>
            </li>
            <li class="nav-item d-flex align-items-center">
                <a class="nav-link ocultar" href="redesGamlist.html">Redes AdServer</a>
            </li>
            <li class="nav-item dropdown d-flex align-items-center">
                <a class="nav-link dropdown-toggle ocultar" href="#" id="navbardrop" data-toggle="dropdown">
                    Ordenes
                </a>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="orden.html">Nueva Orden</a>
                    <a class="dropdown-item" href="ordenList.html">Buscar</a>
                </div>
            </li>
            <li class="nav-item dropdown d-flex align-items-center">
                <a class="nav-link dropdown-toggle ocultar" href="#" id="navbardrop" data-toggle="dropdown">
                    Sincronizar con AdServer
                </a>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="SincronizarOP.html">Detalles OP</a>
                    <a class="dropdown-item" href="SincronizarAnunciantes.html">Anunciantes</a>
                    <a class="dropdown-item" href="SincronizarEmplazamientos.html">Emplazamientos</a>
                    <a class="dropdown-item" href="SincronizarMedidas.html">Medidas</a>
                </div>
            </li>
            <li class="nav-item dropdown d-flex align-items-center">
                <a class="nav-link dropdown-toggle ocultar" href="#" id="navbardrop" data-toggle="dropdown">
                    Reportes
                </a>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="informeVentas.html">Informe de Ventas</a>
                </div>
            </li>
            <li class="nav-item dropdown d-flex align-items-center">
                <a class="nav-link dropdown-toggle" href="#" id="navbardropPresup" data-toggle="dropdown">
                    Presupuestos
                </a>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="Presupuesto.html">Nuevo Presupuesto</a>
                    <a class="dropdown-item" href="PresupuestoList.html">Buscar</a>
                </div>
            </li>
        </ul>
        <ul class="navbar-nav ml-auto">
            <li class="nav-item dropdown d-flex align-items-center">
                <span class="fa fa-user-circle" style="color: #919498;"></span>
                <a class="nav-link dropdown-toggle" href="#" id="NombreUsuario" data-toggle="dropdown">
                    Usuario
                </a>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="perfil.html">Mi Perfil</a>
                    <!--<a class="dropdown-item" href="Configuracion.html">Configuración</a>-->
                    <!--<a class="dropdown-item disabled" id="usuarios" href="usuariosList.html">Usuarios</a>-->
                    <a class="dropdown-item" href="#" onclick="cerrarSesion()">Cerrar Sesión</a>
                </div>
            </li>
            <li>
                <button type="button" class="btn btn-dark" title="Configuración" onclick="abrirConfig()">
                    <span class="fa fa-cog"></span>
                </button>
            </li>
            <li>
                <button type="button" class="btn btn-dark" title="Ver información del sistema" onclick="verInfo()">
                    <span class="fa fa-info-circle"></span>
                </button>
            </li>
        </ul>

        <!--<form class="form-inline mt-2 mt-md-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>-->
    </div>
</nav>
<script type="text/javascript">

    setUserName();
    setUserRol();
    setOcultarModulos();
    callWS("medios", "getParamById", JSON.stringify(8), function (fechas) { checkFechaApi(fechas); });

    function verInfo() {
        callWS("medios", "getInfoSistema", '', function (cs) { onVerInfo(cs); });
    }

    function onVerInfo(cs) {
        arr = cs.split("$$$");

        options = [
            {
                optionDesc: "Cerrar",
                optionFunc: ""
            }
        ];
        var mensaje = "<div class='row'><div class='col' style='padding - right: 0px;'>• Versión:</div><div class='col' style='padding - left: 0px;'><b>" + arr[1] + "</b></div></div><div class='row'><div class='col' style='padding - right: 0px;'>• Base de Datos:</div><div class='col' style='padding - left: 0px;'><b>" + arr[0] + "</b></div></div>";
        showModalInfo(mensaje, options);
    }

    function showModalInfo(message, options) {
        $("#modalInfoBody").html(message);
        strHTML = '';
        options.forEach(function (option) {
            strHTML += "<button type='button' class='btn btn-danger' data-dismiss='modal' onClick=" + option.optionFunc + ">" + option.optionDesc + "</button>"
        });
        $("#modalInfoFooter").html(strHTML);
        $("#modalInfo").modal('show');
    }

    function abrirConfig() {
        location.href = "/Configuracion.html";
    }

    function checkFechaApi(fechas) {
        arr = fechas.valor.split("/");
        fechaBaja = arr[0];
        fechaAtardecer = arr[1];

        var hoy = new Date();
        var dateBaja = new Date(fechaBaja + 'T00:00:00');
        var dateAtardecer = new Date(fechaAtardecer + 'T00:00:00');

        if (hoy > dateBaja && hoy < dateAtardecer) {
            $("#divVencApi").addClass("alert alert-info").html("<span class='fa fa-exclamation-circle'></span><br>La versión actual de la API está por caducar. Se recomienda actualizar").show();
        }
        else if (hoy > dateAtardecer) {
            $("#divVencApi").addClass("alert alert-info").html("<span class='fa fa-exclamation-circle'></span><br>La versión actual de la API ha caducado. Actualizar de inmediato").show();
        }
    }

    function cerrarNoti() {
        $("#divVencApi").hide("slideDown");
    }


</script>

